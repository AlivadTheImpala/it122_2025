<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css"
      integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      body {
        padding: 50px;
      }
    </style>
    <script
      src="https://unpkg.com/react@18/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
      crossorigin
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <title>Music</title>
  </head>

  <body class="container">
    <header>
      <div class="ui inverted menu">
        <a class="item" href="/"> Home </a>
      </div>
    </header>

    <div id="root"></div>

    <script type="text/babel">
          const albumsData = <%- albums %>;
                //albums is being passed in from our albums.js routes and saved to albumData to be used for our component props.
                // console.log(`This is the raw data`, albumsData);

          const AlbumForm = ({item})=> {
            return (
              <form action="">
                <input className="ui segment"type="text" placeholder={item.artist} name="artist"/>

                <input className="ui segment"type="text" placeholder={item.albumTitle} name="albumTitle"/>
                <button className="ui button"type="submit">Submit</button>
              </form>

            )
          }

          const DetailsContainer = ({item}) => {
            if (!item) {
            return <p>Select an album to see details.</p>;
      }
            return(
            <div className="ui segment">
              <h2>Details for {item.albumTitle}</h2>
              <AlbumForm item={item}/>
              <li>Release Date: {item.released}</li>
              <li>Genre: {item.genre}</li>

            </div>
          )};


          const AlbumList = ({ albums, clickHandler }) => {
            const albumItems = albums.map((album) =>
            <li className="ui segment" key={album._id} onClick={() => clickHandler(album)}>
              {album.albumTitle} by {album.artist}
            </li>);

            return <ul>{albumItems}</ul>;
          };

          const AlbumContainer = ({albums, clickHandler}) => {
            // console.log(`This is from AlbumContainer`, albums);
            return (
              <div className="ui segment">

                <AlbumList albums={albums} clickHandler={clickHandler}/>
              </div>
            );
          };

          //parent component
          const App = () => {
            // console.log(albumsData);

            const [selectedItem, setSelectedItem] = React.useState();

            // const albumClicked = (e) => {
            //   let found = albumsData.find((album)=> {
            //     return album.albumTitle == e.target.innerText});
            //     setSelectedItem(found);
            //   }



            return (
            <div>
            <AlbumContainer albums={albumsData} clickHandler={setSelectedItem}/>
            <DetailsContainer item={selectedItem}/>
            </div>
           )
          };

          const container = document.getElementById("root");
          const root = ReactDOM.createRoot(container);
          root.render(<App />);
    </script>
  </body>
</html>
